{% extends 'core/panel.html' %}

{% block title %}Spotkania{% endblock %}

{% load list_events %}

{% block panel_content %}
    <div id="gwardia-main-content" class="w-full overflow-auto">
        <div class="flex flex-col items-center">
            <h1 class="text-4xl font-bold mt-10 mb-8">Spotkania gwardii</h1>
            <p class="italic text-xs text-gray-500 mb-2">Kliknij w dane spotkanie, by wyświetlić jego opis</p>
            <div class="w-3/4" id="js-next-meetings-container">
                {% list_events upcoming_meetings "Nadchodzące" %}
            </div>
            <div class="w-3/4 hidden" id="js-archival-meetings-container">
                {% list_events archival_meetings "Archiwalne" %}
            </div>
            <button class="text-bold border-2 border-solid p-2 rounded-lg mt-8 border-gray-500" id="js-archival-meetings-toggle-button">
                Pokaż spotkania archiwalne
            </button>
        </div>
    </div>
    <script>
        const nextMeetingsContainer = document.getElementById('js-next-meetings-container').lastElementChild;
        nextMeetingsContainer.addEventListener('click', (event) => displayDescription(event.target));
        const archivalMeetingsContainer = document.getElementById('js-archival-meetings-container');
        archivalMeetingsContainer.addEventListener('click', (event) => displayDescription(event.target));
        const archivalMeetingsToggleButton = document.getElementById('js-archival-meetings-toggle-button');
        archivalMeetingsToggleButton.addEventListener('click', displayArchivalMeetings);

        function displayDescription(clickedElement) {
            clickedElement = clickedElement.closest('.js-meeting-container')
            const meetingDescription = clickedElement.lastElementChild;
            document.querySelectorAll('.js-meeting-description').forEach((descriptionElement) => {
                if (descriptionElement === meetingDescription) {
                    return;
                }
                if (!descriptionElement.classList.contains('hidden')) {
                    descriptionElement.classList.add('hidden');
                }
            })
            meetingDescription.classList.toggle('hidden');
        }
        function displayArchivalMeetings() {
            archivalMeetingsContainer.classList.toggle('hidden');
            if (archivalMeetingsContainer.classList.contains('hidden')) {
                archivalMeetingsToggleButton.innerText = 'Pokaż spotkania archiwalne';
            } else {
                archivalMeetingsToggleButton.innerText = 'Ukryj spotkania archiwalne';
            }
        }
    </script>
{% endblock %}
